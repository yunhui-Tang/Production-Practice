(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-23c1ef08","chunk-47147aed"],{"14cf":function(e,t,a){"use strict";var r=a("8d1e"),n=a.n(r);n.a},"274c":function(e,t,a){},"603e":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-card",{attrs:{bordered:!1}},[a("div",{staticClass:"table-operator"},[a("a-button",{attrs:{type:"primary",icon:"plus"},on:{click:function(t){return e.showModal(null)}}},[e._v("新增")])],1),a("div",[a("a-table",{ref:"table",staticClass:"j-table-force-nowrap",attrs:{size:"middle",scroll:{x:!0},bordered:"",rowKey:"id",columns:e.columns,dataSource:e.dataSource,pagination:!1,loading:e.loading},on:{change:e.handleTableChange},scopedSlots:e._u([{key:"status",fn:function(t,r,n){return a("span",{},[0==t?a("a-tag",{attrs:{color:"pink"}},[e._v("禁用")]):e._e(),1==t?a("a-tag",{attrs:{color:"#87d068"}},[e._v("正常")]):e._e()],1)}},{key:"action",fn:function(t,r){return a("span",{},[a("a",{on:{click:function(t){return e.showModal(r)}}},[e._v("编辑")]),a("a-divider",{attrs:{type:"vertical"}}),a("a-dropdown",[a("a",{staticClass:"ant-dropdown-link"},[e._v("更多 "),a("a-icon",{attrs:{type:"down"}})],1),a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},[a("a-menu-item",[a("a-popconfirm",{attrs:{title:"确定删除吗?"},on:{confirm:function(){return e.handleDelete(r.id)}}},[a("a",[e._v("删除")])])],1)],1)],1)],1)}}])})],1),a("gate-way-route-modal",{ref:"modalForm",on:{ok:e.modalFormOk}})],1)},n=[],i=(a("6eb7"),a("ac0d")),o=a("b65a"),s=a("ece6"),l={name:"TenantList",mixins:[o["a"],i["b"]],components:{GateWayRouteModal:s["default"]},data:function(){return{description:"adad管理页面",columns:[{title:"路由ID",align:"center",dataIndex:"routerId"},{title:"路由名称",align:"center",dataIndex:"name"},{title:"路由URI",align:"center",dataIndex:"uri"},{title:"状态",align:"center",dataIndex:"status",scopedSlots:{customRender:"status"}},{title:"操作",dataIndex:"action",align:"center",fixed:"right",width:147,scopedSlots:{customRender:"action"}}],url:{list:"/sys/gatewayRoute/list",delete:"/sys/gatewayRoute/delete"},dictOptions:{}}},created:function(){},methods:{showModal:function(e){this.$refs["modalForm"].show(e)}}},u=l,c=(a("14cf"),a("2877")),d=Object(c["a"])(u,r,n,!1,null,"28fc92be",null);t["default"]=d.exports},"6eb7":function(e,t,a){},"8d1e":function(e,t,a){},c13f:function(e,t,a){"use strict";var r=a("274c"),n=a.n(r);n.a},ece6:function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.visible?a("a-drawer",{staticStyle:{overflow:"auto","padding-bottom":"53px"},attrs:{title:e.title,maskClosable:!0,width:"45%",placement:"right",closable:!0,visible:e.visible},on:{close:e.handleCancel}},[a("a-form-model",{ref:"form",attrs:{layout:e.layout,"label-col":e.labelCol,"wrapper-col":e.wrapperCol,model:e.router}},[a("a-form-model-item",{attrs:{label:"路由ID"}},[a("a-input",{attrs:{placeholder:"路由唯一ID"},model:{value:e.router.routerId,callback:function(t){e.$set(e.router,"routerId",t)},expression:"router.routerId"}})],1),a("a-form-model-item",{attrs:{label:"路由名称"}},[a("a-input",{attrs:{placeholder:"路由名称"},model:{value:e.router.name,callback:function(t){e.$set(e.router,"name",t)},expression:"router.name"}})],1),a("a-form-model-item",{attrs:{label:"路由URI"}},[a("a-input",{attrs:{placeholder:"路由URL"},model:{value:e.router.uri,callback:function(t){e.$set(e.router,"uri",t)},expression:"router.uri"}})],1),a("a-form-model-item",{attrs:{label:"路由状态",prop:"status"}},[a("a-switch",{attrs:{"default-checked":""},model:{value:e.router.status,callback:function(t){e.$set(e.router,"status",t)},expression:"router.status"}})],1),a("a-form-model-item",{attrs:{prop:"predicates",label:"路由条件"}},[e._l(e.router.predicates,(function(t,r){return a("div",[a("a-divider",[e._v(e._s(t.name)+"\n          "),a("a-icon",{attrs:{type:"delete",size:"22"},on:{click:function(t){return e.removePredicate(e.router,r)}}})],1),e.genKeyRouter.includes(t.name)?a("div",[e._l(t.args,(function(n,i){return[i==e.currentTagIndex&&r==e.currentNameIndex?a("a-input",{ref:"input",refInFor:!0,style:{width:"190px"},attrs:{type:"text",size:"small",value:n},on:{change:e.handleInputChange,blur:function(a){return e.handleInputEditConfirm(t,n,i)},keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.handleInputEditConfirm(t,n,i)}}}):a("a-tag",{key:n,attrs:{closable:!0},on:{close:function(){return e.removeTag(t,n)},click:function(t){return e.editTag(n,i,r)}}},[e._v("\n              "+e._s(n)+"\n            ")])]})),e.inputVisible&&r==e.currentNameIndex?a("a-input",{ref:"input",refInFor:!0,style:{width:"100px"},attrs:{type:"text",size:"small",value:e.inputValue},on:{change:e.handleInputChange,blur:function(a){return e.handleInputConfirm(t)},keyup:function(a){return!a.type.indexOf("key")&&e._k(a.keyCode,"enter",13,a.key,"Enter")?null:e.handleInputConfirm(t)}}}):a("a-tag",{staticStyle:{background:"#fff",borderStyle:"dashed"},on:{click:function(a){return e.showInput(t,r)}}},[a("a-icon",{attrs:{type:"plus"}}),e._v("\n            新建"+e._s(t.name)+"\n          ")],1)],2):e._e(),e.genKeyRouter.includes(t.name)?e._e():a("div",[e._l(t.args,(function(r,n){return[a("a-row",[a("a-col",{staticStyle:{"margin-top":"2px"},attrs:{span:5}},["header"==n?a("span",[e._v("Header名称")]):e._e(),"regexp"==n?a("span",[e._v("参数值")]):e._e(),"param"==n?a("span",[e._v("参数名")]):e._e(),"name"==n?a("span",[e._v("Cookie名称")]):e._e()]),a("a-col",{attrs:{span:18}},[a("a-input",{staticStyle:{width:"70%","margin-right":"8px","margin-top":"3px"},attrs:{defaultValue:r,placeholder:"参数值"},on:{change:function(a){return e.valueChange(a,t.args,n)}}})],1)],1)]}))],2)],1)})),a("p",{staticClass:"btn",staticStyle:{"padding-top":"10px"}},[a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},slot:"overlay"},e._l(e.tagArray,(function(t){return a("a-menu-item",{key:t.name,on:{click:function(a){return e.predicatesHandleMenuClick(t)}}},[e._v(e._s(t.name))])})),1),a("a-button",{staticStyle:{"margin-left":"8px",width:"100%"},attrs:{type:"dashed"}},[e._v(" 添加路由条件\n            "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1)],2),a("a-form-model-item",{attrs:{prop:"predicates",label:"过滤器"}},[e._l(e.router.filters,(function(t,r){return a("div",[a("a-divider",[e._v(e._s(t.name)+"\n          "),a("a-icon",{attrs:{type:"delete",size:"22"},on:{click:function(t){return e.removeFilter(e.router,r)}}})],1),e._l(t.args,(function(r,n){return a("div",{key:r.key},[a("a-input",{staticStyle:{width:"45%","margin-right":"8px"},attrs:{placeholder:"参数键"},model:{value:r.key,callback:function(t){e.$set(r,"key",t)},expression:"tag.key"}}),a("a-input",{staticStyle:{width:"40%","margin-right":"8px"},attrs:{placeholder:"参数值"},model:{value:r.value,callback:function(t){e.$set(r,"value",t)},expression:"tag.value"}}),a("a-icon",{staticClass:"dynamic-delete-button",attrs:{type:"minus-circle-o"},on:{click:function(a){return e.removeFilterParams(t,n)}}})],1)})),a("a-button",{staticStyle:{"margin-left":"28%",width:"30%"},attrs:{type:"dashed",size:"small"},on:{click:function(a){return e.addFilterParams(t)}}},[a("a-icon",{attrs:{type:"plus"}}),e._v("\n          添加参数\n        ")],1)],2)})),a("p",{staticClass:"btn",staticStyle:{"padding-top":"10px"}},[a("a-dropdown",[a("a-menu",{attrs:{slot:"overlay"},on:{click:e.filterHandleMenuClick},slot:"overlay"},e._l(e.filterArray,(function(t){return a("a-menu-item",{key:t.key,attrs:{name:t.name}},[e._v(e._s(t.name))])})),1),a("a-button",{staticStyle:{"margin-left":"8px",width:"100%"},attrs:{type:"dashed"}},[e._v(" 添加过滤器\n            "),a("a-icon",{attrs:{type:"down"}})],1)],1)],1)],2),a("a-row",{staticClass:"drawer-bootom-button",style:{textAlign:"right"}},[a("a-button",{style:{marginRight:"8px"},on:{click:e.handleCancel}},[e._v("\n        关闭\n      ")]),a("a-button",{attrs:{type:"primary"},on:{click:e.handleSubmit}},[e._v("确定")])],1)],1)],1):e._e()},n=[],i=a("0fea");function o(e,t){if(null==e)return{};var a,r,n=s(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(n[a]=e[a])}return n}function s(e,t){if(null==e)return{};var a,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)a=i[r],t.indexOf(a)>=0||(n[a]=e[a]);return n}function l(e){return p(e)||d(e)||c(e)||u()}function u(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function c(e,t){if(e){if("string"===typeof e)return f(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);return"Object"===a&&e.constructor&&(a=e.constructor.name),"Map"===a||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?f(e,t):void 0}}function d(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function p(e){if(Array.isArray(e))return f(e)}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}var m={name:"GateWayRouteModal",components:{},data:function(){return{layout:"horizontal",labelCol:{span:3},wrapperCol:{span:14},currentNameIndex:0,currentTagIndex:-1,predicates:{},filterArray:[{key:1,name:"限流过滤器"}],tagArray:[{name:"Path",args:[]},{name:"Header",args:{header:"",regexp:""}},{name:"Query",args:{param:"",regexp:""}},{name:"Method",args:[]},{name:"Host",args:[]},{name:"Cookie",args:{name:"",regexp:""}},{name:"After",args:[]},{name:"Before",args:[]},{name:"Between",args:[]},{name:"RemoteAddr",args:[]}],inputVisible:!1,inputValue:"",url:{update:"/sys/gatewayRoute/updateAll",clear:"/sys/gatewayRoute/clearRedis"},router:this.getRouter(),title:"路由编辑",visible:!1,loading:!1,genKeyRouter:["Path","Host","Method","After","Before","Between","RemoteAddr"]}},methods:{getRouter:function(){return{routerId:"",name:"",uri:"",predicates:[],filters:[]}},show:function(e){e?(e.status=Boolean(e.status),this.router=e):(this.router=this.getRouter(),this.inputValue=""),this.visible=!0,this.currentTagIndex=-1,this.currentNameIndex=-1},close:function(){this.reset(),this.$emit("close"),this.$refs["form"].resetFields(),this.visible=!1},removeTag:function(e,t){var a=e.args.filter((function(e){return e!==t}));e.args=a},predicatesHandleMenuClick:function(e){this.router.predicates.push({args:e.args,name:e.name})},editTag:function(e,t,a){this.currentNameIndex=a,this.currentTagIndex=t},valueChange:function(e,t,a){t[a]=e.target.value},showInput:function(e,t){this.inputVisible=!0,this.currentNameIndex=t},handleInputChange:function(e){this.inputValue=e.target.value},removePredicate:function(e,t){e.predicates.splice(t,1)},removeFilterParams:function(e,t){e.args.splice(t,1)},removeFilter:function(e,t){e.filters.splice(t,1)},addFilterParams:function(e){e.args.push({key:"key"+e.args.length+1,value:""})},filterHandleMenuClick:function(e){0==e.key&&this.router.filters.push({args:[{key:"name",value:"default"},{key:"fallbackUri",value:"forward:/fallback"}],name:"Hystrix",title:this.filterArray[0].name}),1==e.key&&this.router.filters.push({args:[{key:"key-resolver",value:"#{@ipKeyResolver}"},{key:"redis-rate-limiter.replenishRate",value:20},{key:"redis-rate-limiter.burstCapacity",value:20}],name:"RequestRateLimiter",title:this.filterArray[0].name})},handleInputConfirm:function(e){var t=this.inputValue,a=e.args;t&&-1===a.indexOf(t)&&(e.args=[].concat(l(a),[t])),Object.assign(this,{tags:a,inputVisible:!1,inputValue:""}),this.currentTagIndex=-1},handleInputEditConfirm:function(e,t,a){if(this.inputValue){var r=this.inputValue;e.args[a]=r}this.currentTagIndex=-1},reset:function(){this.expandedKeysss=[],this.checkedKeys=[],this.defaultCheckedKeys=[],this.loading=!1},handleCancel:function(){this.close()},handleSubmit:function(){var e=this,t=this.router,a=(t.predicates,t.filters,o(t,["predicates","filters"])),r=a;r.predicates=JSON.stringify(this.router.predicates),r.filters=JSON.stringify(this.router.filters),Object(i["i"])(this.url.update,{router:r}).then((function(t){t.success?(e.close(),e.$emit("ok"),e.$message.success(t.message)):e.$message.error(t.message)}))}}},h=m,y=(a("c13f"),a("2877")),g=Object(y["a"])(h,r,n,!1,null,"95cc2308",null);t["default"]=g.exports}}]);